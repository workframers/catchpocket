;; This is the music data model, but with datomic annotations included.
[[;; Schema - artist
  {:db/ident       :artist/id
   :db/valueType   :db.type/long
   :db/cardinality :db.cardinality/one
   :db/unique      :db.unique/identity}
  {:db/ident       :artist/name
   :db/valueType   :db.type/string
   :db/cardinality :db.cardinality/one}
  {:db/ident       :artist/albums
   :db/valueType   :db.type/ref
   :db/cardinality :db.cardinality/many}
  ;; Album
  {:db/ident       :album/id
   :db/valueType   :db.type/long
   :db/cardinality :db.cardinality/one
   :db/unique      :db.unique/identity}
  {:db/ident       :album/name
   :db/valueType   :db.type/string
   :db/cardinality :db.cardinality/one}
  {:db/ident       :album/year
   :db/valueType   :db.type/long
   :db/cardinality :db.cardinality/one}
  {:db/ident       :album/tracks
   :db/valueType   :db.type/ref
   :db/cardinality :db.cardinality/many
   :db/isComponent true}
  ;; Track
  {:db/ident       :track/id
   :db/valueType   :db.type/long
   :db/cardinality :db.cardinality/one
   :db/unique      :db.unique/identity}
  {:db/ident       :track/name
   :db/valueType   :db.type/string
   :db/cardinality :db.cardinality/one}
  {:db/ident       :track/position
   :db/valueType   :db.type/long
   :db/cardinality :db.cardinality/one}]

 ;; This is the schema needed to attach annotations to attributes
 [{:db/ident       :catchpocket/lacinia-field-name
   :db/doc         "During catchpocket schema generation, use this keyword for the name of the given field."
   :db/valueType   :db.type/keyword
   :db/cardinality :db.cardinality/one}
  {:db/ident       :catchpocket/lacinia-backref-name
   :db/doc         "During catchpocket schema generation, create a reference from the type of entity this field points to with the given name."
   :db/valueType   :db.type/keyword
   :db/cardinality :db.cardinality/one}
  {:db/ident       :catchpocket/lacinia-field-type
   :db/doc         "During catchpocket schema generation, use this value as the lacinia type of the field generated by this entity."
   :db/valueType   :db.type/keyword
   :db/cardinality :db.cardinality/one}
  {:db/ident       :catchpocket/lacinia-backref-cardinality
   :db/doc         "During catchpocket schema generation, if this is true construct a single-field backref, rather than a list."
   :db/valueType   :db.type/keyword
   :db/cardinality :db.cardinality/one}]

 ;; Here we attach the catchpocket attributes to ref fields so catchpocket finds them at generate time
 [{;; For testing, we aren't including a backref name for this field
   :db/id                          :artist/albums
   :catchpocket/lacinia-field-type :Album}
  {:db/id                                   :album/tracks
   :catchpocket/lacinia-field-type          :Track
   :catchpocket/lacinia-backref-name        :album
   :catchpocket/lacinia-backref-cardinality :stillsuit.cardinality/one}
  {:db/id                          :album/year
   :catchpocket/lacinia-field-name :override_year}
  {:db/id                          :track/position
   :catchpocket/lacinia-field-type 'Int}]

 ;; Data
 [{:db/id       "crass"
   :artist/id   1
   :artist/name "Crass"}
  {:db/id          "feeding"
   :album/id       2
   :album/name     "The Feeding of the 5000"
   :album/year     1977
   :artist/_albums "crass"}
  {:db/id          "feeding1"
   :track/id       3
   :track/name     "Asylum"
   :track/position 1
   :album/_tracks  "feeding"}
  {:db/id          "feeding2"
   :track/id       4
   :track/name     "Do They Owe Us a Living?"
   :track/position 2
   :album/_tracks  "feeding"}
  {:db/id          "feeding3"
   :track/id       5
   :track/name     "End Result"
   :track/position 3
   :album/_tracks  "feeding"}
  {:db/id          "stations"
   :album/id       6
   :album/name     "Stations of the Crass"
   :album/year     1979
   :artist/_albums "crass"}
  {:db/id          "stations1"
   :track/id       7
   :track/name     "Mother-Earth"
   :track/position 1
   :album/_tracks  "stations"}
  {:db/id          "stations2"
   :track/id       8
   :track/name     "White Punks on Hope"
   :track/position 2
   :album/_tracks  "stations"}
  {:db/id          "stations3"
   :track/id       9
   :track/name     "You've Got Big Hands"
   :track/position 3
   :album/_tracks  "stations"}
  {:db/id       "subhumans"
   :artist/id   10
   :artist/name "Subhumans"}
  {:db/id          "day"
   :album/id       11
   :album/name     "The Day the Country Died"
   :album/year     1983
   :artist/_albums "subhumans"}
  {:db/id          "day1"
   :track/id       12
   :track/name     "All Gone Dead"
   :track/position 1
   :album/_tracks  "day"}
  {:db/id          "day2"
   :track/id       13
   :track/name     "Ashtray Dirt"
   :track/position 2
   :album/_tracks  "day"}]]
